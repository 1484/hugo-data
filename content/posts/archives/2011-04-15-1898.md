+++
date = "2011-04-15T10:58:24+09:00"
draft = false
title = "うっかりhistoryを予防しよう"
categories = ["computer"]
slug = "1898"
+++

自分のサーバやクライアントでは極力sudoを使うように設定を組んでいる為、SuperUserでのコンソール作業ってのは基本的に無い様にしているのですが、仕事でおきゃくさまのサーバをいじるとなるとなかなかそうもいかず、サーバのコンソールで作業したりする事も。すげードキドキですが、そんな時に限ってうっかりしてしまうもの。と言う事で設定ファイルをいじったりせずうっかり防止するようにします。

<strong>historyを消去する</strong>
これはまぁお客さんの同意を得なければなりませんが、historyにhaltとか入っているとおっかないものです。どっかで何かのタイミングでチャタってコマンドを投げ込んじゃったりしたら目も当てられません。
と言う事で
<code>history -c</code>
これでhistoryを消去出来ます。


<strong>一部コマンドはhistoryに残さない</strong>
また管理する側としても、時折来てそうさしてもらうCEさんにうっかりされない為に以下設定をしておいてもよいかもしれません。昨今のLinuxであれば /etc/bashrc を全ユーザが読み込むので、そこに１行

{{< highlight bash >}}

export HISTIGNORE=shutdown*:halt*:init*

{{< / highlight >}}


これでハードの交換修理やその他要因でshutdownを伴う作業をした際に入力したshutdown等のコマンドをhistoryに残しません。もっとも .bash_logout にhistory -cを組み込んでしまえばいいとも思いますが、たまーに手入力するけどやたら長いコマンドとか残しておきたい心情もあり、特定コマンドをhistoryを残さないと言う対処方法もまぁ１つかな。と。

結構長いことLinuxに触れてきているつもりですけれど、まだまだ知らない世界が多いです。
