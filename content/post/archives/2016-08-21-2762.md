+++
date = "2016-08-21T22:25:20+09:00"
draft = false
title = "RICOH GR IIへAndroid6.0.1の端末でアクセスする"
categories = ["gadget"]
slug = "2762"
+++

<a href="/images/2016/08/Screenshot_20160821-133753.png"><img src="/images/2016/08/Screenshot_20160821-133753-169x300.png" alt="Image Sync起動画面" width="169" height="300" class="size-medium wp-image-2763" /></a>

<a href="http://www.ricoh-imaging.co.jp/japan/products/gr-2/" target="_blank">RICOH製デジタルカメラ、GR II</a>を愛用しています。昨今のデジタルカメラはWi-Fi機能が付いており、撮って出しをするのにとても便利。私も趣味としているサイクリングやバイクでのツーリングの欠かせない機能と考えています。ちょっと前までのデジタルカメラにはそんな機能はありませんでしたから<a href="http://jp.eyefi.com/" target="_blank">Eye-Fi</a>を買ってみたり<a href="http://www.flashair.info/" target="_blank">FlashAir</a>を買ってみたり。とにかく旅の荷物は減らしたかったのです。もちろんスマートフォンのカメラもどんどん高性能になってますし、私自身スマートフォンを買うとき一番に気にするのがカメラの性能だったりします。それでもやっぱりカメラには全然かなわないですよね。やっぱりデジカメは欠かせないのです。

<!--more-->

Android端末やiOS端末で<a href="http://www.ricoh-imaging.co.jp/japan/support/download/app/image-sync/" target="_blank">Image Sync</a>と言うアプリをPlay StoreやApp Storeからインストールして接続します。私はAndroid端末を愛用していますのでPlayStoreからダウンロードして手順の通り接続してみました。が、デジカメに接続できません。何度やってもダメ。NFCにタッチしてちゃんとデジカメのESSIDに接続が切り替わっている事は確認できるのですが、その後がだんまりでカメラに繋がりません。はてさて、困り果ててしまいました。

あまりにダメなのでapkをダウンロードしてきて分解、中身を確認するとAPIの詳細が分かりましたのでPCで接続してAPIをたたいてみるとちゃんと動作はしているようです。と言う事はアプリの問題？

所でAndroidアプリについて対応バージョンとしては先のページにAndroid4.4～6.0対応とあります。私が使っているスマートフォンは何台かありますが、こーいう時はリファレンス機で確認するのが一番だろうと言う事でNexus6を用意しました。Versionは6.0.1になります。普通なら何も問題ないと考えますがやはり接続できません。内容が接続できない、と言うものなのでNetworkを疑いIPアドレスを疑ってみました。PCで接続した時に払い出されるアドレス帯は192.168.0.0/24と言う事が確認出来ました。Androidでは設定アプリの本体情報を調べるとIPアドレスが確認出来ますが、見えるアドレスが違いました。ん？
<a href="/images/2016/08/Screenshot_20160820-193830.png"><img src="/images/2016/08/Screenshot_20160820-193830-169x300.png" alt="接続維持ダイアログ" width="169" height="300" class="alignleft size-medium wp-image-2764" /></a>
もしかしたら複数IPアドレスが振られてて2つめ以降が見えてないのかな？と思いましたのでネットワークツールをインストールして確認しました。やはりアドレスは確認出来ず、pingを打ってみてもやはり届きません。アドレスが正しく振れてないようです。

そういう目線で動作を確認していると気になるダイアログがありました。

<blockquote>このネットワークはインターネットに接続していません。接続を維持しますか？</blockquote>

アプリ動作中ではバックグラウンドで出ているので気付く事が出来ませんでした。結果的にはこのダイアログで「はい」を選んで接続を維持するのが大正解。おそらくこの「はい」を選択する事でアドレスが振られるようになっているのだと思います。

ここで「はい」とする事で接続できるのは確認出来ましたが、じゃあどの様に運用したらよいでしょう？
次の手順のためには、Wi-Fi接続を1度しておき、認証情報がAndroid端末に保存されている事が必要です。

<ol>
	<li>再生ボタン長押しして電源を入れる</li>
	<li>メニューからWiFiをONにする。設定を変えていなかったら、カメラ脇にあるWi-Fiボタンを長押しすることでも繋がります（ピピッとなって画面にWi-Fiマークが現れる）</li>
	<li>Wi-Fiに現在繋がっていなければ自動的に接続されると思います。他のWi-Fiに接続している場合接続変更する手順が必要（ここがちょっと面倒）</li>
	<li>上記内容のダイアログが通知バーに表示されるのでタップし、表示される上記ダイアログで「はい」を選択</li>
	<li>Image Syncを起動する</li>
</ol>

これでアプリで接続できるようになりました。

なんとかこれで運用は出来そうですがちょっと手間ですので、Wi-Fiを切り替える所（ここは既にアプリで実装出来ています）や、接続を継続するダイアログなんかの部分（今回の問題はここ）についてはアプリ側で制御をして欲しい所です。

メーカーのエンジニア様、是非上記の改善を宜しくお願いします。
